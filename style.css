/* Mobile-first, themed CSS pour un univers mmorp */
:root{
  --bg: #0f1113;
  --panel: #111217;
  --muted: #bdb6a8;
  --accent: #b25a3a;
  --accent-2: #9ec06b;
  --glass: rgba(255,255,255,0.03);
  --radius: 12px;
}

*{box-sizing:border-box}
html,body{height:100%}
/* prevent horizontal overflow on small screens */
body{overflow-x:hidden}
body{
  margin:0;
  font-family: 'Roboto Mono', monospace;
  background: linear-gradient(180deg,#0b0c0d 0%, #141515 100%);
  color:var(--muted);
  -webkit-font-smoothing:antialiased;
  padding:16px;
}

.site-header{display:flex;align-items:center;justify-content:center;margin-bottom:12px}
.title-wrap h1{font-family:Cinzel, serif;color:var(--accent);margin:0;font-size:1.6rem}
.tagline{margin:0;font-size:0.75rem;color:#8f8b82}

.container{display:grid;gap:12px;grid-template-columns:1fr}
.panel{
  background:linear-gradient(180deg,var(--panel),#0b0b0b);
  padding:12px;border-radius:var(--radius);
  box-shadow:0 6px 18px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.02)
}

.player .player-head{display:flex;flex-direction:column;gap:8px}
.hp-bar{height:12px;background:rgba(255,255,255,0.04);border-radius:10px;overflow:hidden}
.hp-fill{height:100%;background:linear-gradient(90deg,var(--accent-2),#ffd36b);width:100%}

/* XP bar (under HP) */
.xp-bar{height:8px;background:rgba(255,255,255,0.03);border-radius:8px;overflow:hidden;margin-top:6px}
.xp-bar .hp-fill{height:100%;width:0%;transition:width 300ms ease}

.stats{white-space:pre-line;font-size:0.85rem;color:#e6e1d9}
.inventory{font-size:0.85rem;color:#cfc6b7;margin-top:8px}

/* Equipment and inventory UI */
.equipment-panel{margin-top:10px}
.equipment{display:flex;flex-wrap:wrap;gap:8px}
.equip-slot{min-width:64px;min-height:64px;border-radius:8px;background:rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:center;flex-direction:column;padding:6px;border:1px solid rgba(255,255,255,0.03)}
.equip-slot{position:relative}
.equip-slot .slot-name{font-size:0.7rem;color:#bfb8a9}
.equip-slot .slot-item{font-size:0.8rem;color:#fff;margin-top:4px}
.inventory-panel{margin-top:10px}
.inventory-list{display:flex;flex-wrap:wrap;gap:8px}
.inv-item, .shop-item, .catalog-item{
  display:flex;
  flex-direction:column;
  gap:8px;
  padding:12px;
  border-radius:12px;
  background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.03);
  box-shadow: 0 6px 14px rgba(0,0,0,0.55);
  width:100%;
  box-sizing:border-box;
  transition:transform 120ms ease, box-shadow 120ms ease;
}
.catalog-item:hover{ transform:translateY(-3px); box-shadow:0 12px 30px rgba(0,0,0,0.65) }
.inv-item .item-actions, .shop-item .item-actions, .catalog-item .item-actions{display:flex;gap:8px;flex-wrap:wrap}
.inv-item .item-main, .shop-item .item-main, .catalog-item .item-main{display:flex;justify-content:space-between;align-items:center;gap:12px}
.inv-item button, .shop-item button{padding:6px 8px;border-radius:8px;font-size:0.85rem}
.inv-item{position:relative}
.shop-item{position:relative}

/* Item tooltip shown on hover */
.item-tooltip{display:none;position:absolute;left:110%;top:0;min-width:200px;max-width:320px;background:linear-gradient(180deg,rgba(20,20,20,0.98),rgba(10,10,10,0.95));padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 8px 24px rgba(0,0,0,0.6);z-index:60;color:var(--muted);font-size:0.85rem}
.inv-item:hover .item-tooltip, .shop-item:hover .item-tooltip, .catalog-item:hover .item-tooltip, .equip-slot:hover .item-tooltip{display:block}

/* Tooltip for inventory items: show to the left to avoid overflowing modals */
.inv-item .item-tooltip{left:auto;right:110%;top:0;z-index:1102}
.equip-slot .item-tooltip{left:auto;right:110%;top:0;z-index:5000;pointer-events:auto}
.equip-slot:hover .item-tooltip{display:block}

/* When equip slots are rendered inside a modal, show tooltip to the right (inside modal) */
.modal .equip-slot .item-tooltip{left:110%;right:auto;top:0;z-index:1300;pointer-events:auto}
.modal .equip-slot:hover .item-tooltip{display:block}

/* Ensure tooltips inside the modal don't overflow viewport badly */
.modal .item-tooltip{max-width:46vw}

/* For catalog entries show tooltip to the left to avoid going off-screen */
.catalog-item .item-tooltip{left:auto;right:110%}
/* For shop (right column) show tooltip to the left inside the window */
.shop .shop-item .item-tooltip{left:auto;right:110%}
.item-tooltip .tt-name{font-weight:700;margin-bottom:6px;color:#fff}
.item-tooltip .tt-row{display:flex;justify-content:space-between;padding:2px 0}
.item-tooltip .tt-row .label{color:#bfb8a9}
.item-tooltip .tt-row .value{color:#e6e1d9}
.catalog-item{margin-bottom:8px}
.drop-rate{font-size:0.8rem;color:#c9d6c3;margin-left:8px}

.arena .arena-top{display:flex;gap:8px;align-items:center;justify-content:space-between}
.enemy-info{font-size:0.9rem;color:#f0d9c1}


.log{
  margin-top:10px;
  background:linear-gradient(180deg,#0b0b07,#0f0f0f);
  padding:10px;
  height:140px;
  overflow:auto;
  border-radius:8px;
  font-size:0.85rem;
  color:#dfe7e1;
  display:flex;
  flex-direction:column;
  gap:8px;
  white-space:normal;
}
.log::selection{background:rgba(255,255,255,0.08)}

.log-line{
  background:rgba(255,255,255,0.02);
  padding:8px 10px;border-radius:8px;color:#e6e7e3;font-size:0.9rem;
}

.log-line.muted{opacity:0.85;color:#bfbdb5;background:transparent;font-style:italic}

.actions{display:flex;gap:10px;margin-top:10px}
.btn{padding:10px 12px;border-radius:10px;border:0;background:var(--glass);color:var(--muted);font-weight:700}
.btn.primary{background:linear-gradient(180deg,#2a2f33,#1b1f22);color:#fff}
.btn.danger{background:linear-gradient(180deg,#7a2216,#b23b2b);color:#fff}
.btn:active{transform:translateY(1px)}

/* Mobile fixed controls (bottom) */
.mobile-controls{position:fixed;left:0;right:0;bottom:0;display:flex;gap:12px;justify-content:space-around;align-items:center;padding:12px;background:linear-gradient(180deg,rgba(11,11,11,0.9),rgba(6,6,6,0.85));box-shadow:0 -8px 30px rgba(0,0,0,0.6);z-index:1200;padding-bottom:calc(12px + env(safe-area-inset-bottom, 0px));}
.mobile-controls .btn{padding:14px 18px;font-size:1rem;min-width:88px;border-radius:14px}
.mobile-controls .btn:active{transform:translateY(1px) scale(0.995)}
.mobile-controls .btn:focus{outline:2px solid rgba(255,255,255,0.08);outline-offset:2px}
.mobile-controls .btn{ -webkit-tap-highlight-color: transparent; touch-action: manipulation }

@media(min-width:900px){
  .mobile-controls{display:none}
}

.shop{display:none}
.shopItem,.shop-item{padding:8px;border-radius:8px;background:rgba(255,255,255,0.02);color:var(--muted);border:1px solid rgba(255,255,255,0.02)}

/* Modal/backdrop styles for shop and catalog */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.55);z-index:900;display:none}
.shop, #catalog{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:linear-gradient(180deg,var(--panel),#0b0b0b);padding:12px;border-radius:12px;box-shadow:0 12px 36px rgba(0,0,0,0.7);z-index:1000;max-width:95vw;width:92vw;max-height:90vh;overflow:auto;border:1px solid rgba(255,255,255,0.03)}

/* Inventory/Equipment modal (large padding) */
.modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);z-index:1001;display:none;width:min(960px,94vw);max-height:90vh;overflow:auto;border-radius:16px;background:linear-gradient(180deg,var(--panel),#0b0b0b);border:1px solid rgba(255,255,255,0.03);box-shadow:0 18px 48px rgba(0,0,0,0.75)}
.modal .modal-content{padding:48px;box-sizing:border-box}
.modal-close{position:absolute;right:18px;top:18px;background:transparent;border:0;color:var(--muted);font-size:1.1rem}
.modal-columns{display:flex;flex-direction:column;gap:24px;margin-top:12px}
.modal-column{flex:1}
@media(min-width:800px){
  .modal-columns{flex-direction:row;gap:32px}
  .modal .modal-content{padding:64px}
}

/* Equipment figure layout */
.equipment{position:relative;min-height:360px;display:block}
.equipment-figure{width:320px;max-width:78%;margin:0 auto}
.equipment-figure svg{display:block;width:100%;height:auto}
.equipment-slots{position:absolute;inset:0;pointer-events:auto}
.equipment .equip-slot{position:absolute;pointer-events:auto;min-width:56px;min-height:56px;padding:6px;display:flex;align-items:center;justify-content:center}

/* Positioning of individual slots around the humanoid (percent based) */
.equipment .slot-chapeau{left:50%;top:3%;transform:translate(-50%,0)}
.equipment .slot-arme{left:12%;top:40%;transform:translate(-50%,-50%)}
.equipment .slot-botte{left:50%;bottom:6%;transform:translate(-50%,0)}
.equipment .slot-plastron{left:50%;top:46%;transform:translate(-50%,-50%)}
.equipment .slot-amulette{left:50%;top:30%;transform:translate(-50%,-50%)}
.equipment .slot-anneau{left:75%;top:55%;transform:translate(-50%,-50%)}
.equipment .slot-ceinture{left:50%;top:62%;transform:translate(-50%,-50%)}
.equipment .slot-artefact{left:88%;top:20%;transform:translate(-50%,-50%)}

/* Tweak visuals for absolute slots to match existing style */
.equipment .equip-slot{border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);box-shadow:0 8px 20px rgba(0,0,0,0.5);}

/* Familliers slot (bottom-left) */
.equipment .slot-familliers{left:18%;bottom:10%;transform:translate(-50%,0)}

/* On larger screens keep modals a bit narrower */
@media(min-width:900px){
  .shop, #catalog{width:min(720px,88vw)}
}

/* Mobile / small-screen adjustments for Inventory modal */
@media(max-width:899px){
  /* Make modal act like a full-screen sheet for easier touch interaction */
  .modal{
    position:fixed;
    left:0; top:0; right:0; bottom:0;
    width:100vw; height:100vh;
    transform:none; border-radius:0;
    margin:0; overflow:auto; z-index:1201; max-height:none;
  }
  .modal .modal-content{padding:18px}
  .modal-columns{flex-direction:column;gap:12px}
  .modal-column{width:100%}

  /* Hide the decorative humanoid figure to reduce clutter */
  .equipment-figure{display:none}
  .equipment{min-height:auto;display:block}

  /* Render equip slots as a responsive grid / list instead of absolute positioning */
  .equipment-slots{position:static;display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:8px;padding:4px}
  .equipment .equip-slot{position:relative;min-width:0;min-height:72px;padding:10px;display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border:1px solid rgba(255,255,255,0.03);box-shadow:none}
  .equipment .slot-name{font-size:0.78rem;color:#d6cfc1;margin-bottom:6px}
  .equipment .slot-item{font-size:0.95rem;color:#fff}
  .equipment .equip-slot button{margin-top:8px;padding:8px 10px;border-radius:8px;font-size:0.9rem}

  /* Make inventory items stack nicely and enlarge tap targets */
  .inv-item, .shop-item, .catalog-item{padding:10px;border-radius:10px;width:100%}
  .inv-item .item-actions button, .shop-item .item-actions button, .catalog-item .item-actions button{padding:8px 10px}

  /* Disable hover tooltips on touch devices to avoid overlapping UI — show no tooltips by default */
  .item-tooltip{display:none !important}

  /* Hide explicit "Déséquiper" buttons on mobile — tap the slot to unequip */
  .equipment .equip-slot button{display:none}

  /* Ensure modal close is reachable and larger */
  .modal-close{right:14px;top:12px;font-size:1.3rem}
}

/* Tier legend */
.tier-legend{margin-top:12px;padding:8px;border-radius:8px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02)}
.tier-legend h4{margin:0 0 6px 0;font-size:0.85rem;color:#e9e6da}
.tier-items{display:flex;flex-direction:column;gap:6px}
.tier-item{display:flex;align-items:center;gap:8px;font-size:0.85rem}
.tier-item .swatch{width:18px;height:12px;border-radius:4px;border:1px solid rgba(255,255,255,0.04)}
.tier-item .tier-name{min-width:80px;color:#dcd6c8}
.tier-item .tier-range{color:#bfb8a9;font-size:0.8rem}

/* Enemy cards */
.enemy-cards{display:flex;flex-direction:column;gap:8px}
.enemy-card{padding:10px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;gap:6px}
.enemy-card .ec-head{display:flex;justify-content:space-between;align-items:center}
.enemy-card .ec-name{font-weight:700}
.enemy-card .ec-meta{font-size:0.82rem;color:#cfc6b7}
.enemy-card .ec-stats{display:flex;gap:12px;font-size:0.9rem;color:#e6e1d9}
.enemy-card .ec-stats .stat{padding:4px 6px;border-radius:6px;background:rgba(0,0,0,0.12)}
.enemy-card[data-dead="true"]{opacity:0.5}

.site-footer{text-align:center;color:#777;font-size:0.75rem;margin-top:12px}

/* Desktop layout */
@media(min-width:900px){
  .container{grid-template-columns:260px 1fr 220px;grid-template-rows:auto 1fr;grid-template-areas:"player arena shop" "player log shop";gap:12px}
  /* fix log height on desktop */
  .log{height:260px}
  /* assign areas */
  #playerPanel{grid-area:player}
  #arenaPanel{grid-area:arena}
  #logPanel{grid-area:log}
  #shopPanel{grid-area:shop}
  /* on wide screens show items as rows */
  .inv-item, .shop-item, .catalog-item{flex-direction:row;align-items:center}
  .inv-item .item-main, .shop-item .item-main, .catalog-item .item-main{flex:1}
}

/* Accessibility and small touches */
.btn:focus{outline:2px solid rgba(255,255,255,0.06);outline-offset:2px}

/* Combat visual effects */
.enemy-card{position:relative}
.damage-float{position:absolute;right:12px;top:8px;background:rgba(0,0,0,0.6);color:#fff;padding:6px 8px;border-radius:8px;font-weight:800;font-size:0.95rem;pointer-events:none;z-index:2200;opacity:0}
.damage-float.enemy-damage{background:linear-gradient(90deg,rgba(180,40,40,0.95),rgba(220,80,80,0.95));}
.damage-float.player-damage{right:12px;top:12px;background:linear-gradient(90deg,rgba(120,20,20,0.95),rgba(180,40,40,0.95));}

@keyframes floatUp { from { transform: translateY(0); opacity:1 } to { transform: translateY(-28px); opacity:0 } }
.damage-float{animation: floatUp 700ms ease-out forwards}

@keyframes shakeX { 0% { transform: translateX(0) } 25% { transform: translateX(-6px) } 50% { transform: translateX(6px) } 75% { transform: translateX(-3px) } 100% { transform: translateX(0) } }
.enemy-card.shake{animation: shakeX 360ms ease-in-out}

/* enemy killed pulse */
.enemy-card.enemy-dead{animation: enemyDead 520ms ease-out forwards}
@keyframes enemyDead { 0% { transform: scale(1); opacity:1 } 60% { transform: scale(1.08); opacity:1 } 100% { transform: scale(0.92); opacity:0.12 } }

/* player hit highlight on hp bar */
.hp-bar.player-hit{box-shadow:0 0 14px rgba(255,40,40,0.9) inset; animation: hpFlash 420ms ease-out}
@keyframes hpFlash { 0% { box-shadow:0 0 30px rgba(255,80,80,0.95) inset } 100% { box-shadow:0 0 6px rgba(255,40,40,0.6) inset } }

/* small kill burst icon */
.kill-burst{position:absolute;left:50%;top:30%;transform:translate(-50%,-50%);font-size:20px;z-index:2300;animation: burst 520ms ease-out forwards}
@keyframes burst { 0% { transform:translate(-50%,-50%) scale(0.4); opacity:1 } 60% { transform:translate(-50%,-60%) scale(1.2); opacity:1 } 100% { transform:translate(-50%,-80%) scale(1); opacity:0 } }

/* Level up effect */
.levelup-badge{position:fixed;left:50%;top:18%;transform:translateX(-50%) translateY(-10px) scale(0.92);background:linear-gradient(90deg,#ffd36b,#ffd36b 50%,#ffd36b);color:#111;padding:12px 18px;border-radius:12px;font-weight:900;z-index:2500;box-shadow:0 12px 36px rgba(255,200,90,0.12);opacity:0}
.levelup-badge.show{animation: levelUpIn 900ms cubic-bezier(.2,.9,.2,1) forwards}
@keyframes levelUpIn { 0% { transform:translateX(-50%) translateY(-10px) scale(0.92); opacity:0 } 40% { transform:translateX(-50%) translateY(0) scale(1.12); opacity:1 } 100% { transform:translateX(-50%) translateY(-6px) scale(1); opacity:1 } }

.player-panel-pulse{animation: playerPulse 900ms ease-out}
@keyframes playerPulse { 0% { transform:scale(1) } 30% { transform:scale(1.06) } 100% { transform:scale(1) } }

/* Confetti simple particles (DOM based) */
.confetti-piece{position:fixed;width:8px;height:10px;border-radius:2px;z-index:2499;opacity:0;pointer-events:none}
@keyframes confettiFall { 0% { transform:translateY(-10vh) rotate(0deg); opacity:1 } 100% { transform:translateY(80vh) rotate(720deg); opacity:0 } }

