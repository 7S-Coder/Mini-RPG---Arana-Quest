Arena Quest ‚Äî Game Design Document (GDD)
Version : D√©cembre 2025 ‚Äî Auteur : Dylan Eglantine

0. Introduction

Arena Quest est un RPG ar√®ne/donjon en JavaScript natif orient√© combat, progression, loot et optimisation du personnage.
Le jeu repose sur des m√©caniques inspir√©es des RPG classiques (Diablo, Dofus, Shakes & Fidget) avec :
combats tour par tour,
loot al√©atoire avec raret√©s,
donjons √† salles d√©terministes,
syst√®me d‚ÄôXP, mont√©e de niveau, scaling ennemi,
boutique & √©conomie interne,
√©quipements, inventaire & familiers.
Ce document pr√©cise toutes les m√©caniques actuelles, les formules et les syst√®mes, dans un format GDD professionnel.

1. Syst√®mes de Jeu

1.1 Boucle de Gameplay principale

Le joueur entre dans l‚Äôar√®ne ‚Üí g√©n√©ration d‚Äôune rencontre :

1‚Äì3 ennemis via newEncounter().

Les combats sont tour par tour.
Chaque attaque suit la formule :
d√©g√¢ts = max(1, player.damage ‚àí enemy.defense) (post-esquive, post-critique).
Lorsqu‚Äôun ennemi meurt :
gain d‚ÄôXP
gain de gold
test de drop d‚Äôitem selon raret√©
√Ä la fin d‚Äôun combat :
endCombatCleanup() r√©initialise le state
la liste des ennemis est vid√©e.

2. Progression ‚Äî XP, Niveaux, Stats

2.1 XP requise

xpToNextLevel(lvl) = max(20, 100 * lvl)

2.2 Level-up

Lors d‚Äôune mont√©e de niveau :
PV max : +10 + floor(newLevel √ó 1.5)
D√©g√¢ts de base : +2 + floor(newLevel / 10)
D√©fense de base : +1 + floor(newLevel / 15)
‚Üí Puis recalcStatsFromEquipment() applique les bonus des items.

2.3 Plafond de niveau

MAX_LEVEL = 80
Au niveau 80 :
plus de mont√©e possible
XP automatiquement plafonn√©e
message : "Niveau maximum atteint (80)."

3. Syst√®me d‚ÄôXP ‚Äî Formule compl√®te

3.1 Formule appliqu√©e

baseXp = randInt(6,16)
levelFactor = 1 + (enemy.level / 10)
rarityMult :
  common = 1
  rare = 1.5
  epic = 2
  legendary = 3
  mythic = 6
xpGain = max(1, floor(baseXp * levelFactor * rarityMult))

Exemple
Ennemi √©pique, niveau 20
levelFactor = 3.0
rarityMult = 2
Total = 6√ó multiplication
‚Üí XP ‚âà baseXp * 6

4. Donjons

4.1 G√©n√©ration

Donjons compos√©s de multi-salles.
Bas√©s sur un seed d√©terministe ‚Üí m√™mes salles pour une m√™me graine.
Stockage : currentDungeon.rooms.

4.2 √âvolutions possibles

persistance HP ennemis dans le donjon (instances)
ajustement dynamique de difficult√© (tier scaling)

5. Ennemis

5.1 Paliers d‚Äôennemis (ENEMY_TIERS)
Raret√©	Niveau	Exemple	Notes
Common	1‚Äì5	Gobelin, Slime	Tr√®s fr√©quent
Rare	6‚Äì15	Brigand, Ogre	Menace mod√©r√©e
Epic	16‚Äì30	Golem, Wyrm	R√©sistants
Legendary	31‚Äì59	Seigneur du Fl√©au	Durs
Mythic	60+	Boss mythiques	Tr√®s rares

5.2 Scalings

HP ‚âà 20 + lvl^1.35 √ó (6..9)
DMG ‚âà lvl √ó (0.8..2.0)
DEF ‚âà lvl √ó (0.5..1.1)

5.3 Esquive & critiques

syst√®mes pour joueur & ennemis
crit multiplier ‚âà 1.5

6. √âconomie

6.1 Gains lors d‚Äôun kill

Gold : randInt(4,14)
XP : via la formule d√©taill√©e ci-dessus

6.2 Boutique

Potions : 20 gold
Equipements : ITEMS[id].cost
Vente :
sellPrice = max(1, floor(cost * 0.5))

7. Items & √âquipements

7.1 Structure

Chaque item contient :
id
name
rarity
type
dmg / def / dodge / hp / crit
heal (optionnel)
cost
stats auto via applyAutoStatsToItems()

7.2 Emplacements

Arme
Armure
Ceinture
Botte
Coiffe
Anneau
Familliers (nouveau)

7.3 Calcul des stats

recalcStatsFromEquipment() :
additionne d√©gats, d√©fenses, HP bonus, critique, esquive
applique les valeurs dans le Player Object

8. Taux de drop

8.1 RARITY_DROP_RATES

Raret√©	Probabilit√© par kill
Common	30%
Rare	12%
Epic	8%
Legendary	1%
Mythic	0.2%

8.2 Processus

Roll global sur totalDrop
S√©lection de la raret√© proportionnelle
S√©lection d‚Äôun item dans DROPPABLE_ITEMS

9. Boutique ‚Äî Rotation horaire

Bas√©e sur getHourSeedIndex()
Affiche 3 √©quipements premium par heure
Affichage du type et des stats inline

10. Sauvegarde / Persistance

10.1 Sauvegarde

Stock√©e dans :
localStorage["tpgame_player_v1"]

Contient :
stats
inventaire
√©quipements
gold
XP & niveau
familiers √©quip√©s
salle de donjon en cours

11. Familiers (Nouvelle M√©canique)

11.1 Fonctionnement

Ajout d‚Äôun slot familliers
stats :
famAttack (attaque automatique apr√®s le joueur)
def (bonus de d√©fense)
affich√©es et appliqu√©es via recalcStatsFromEquipment()

11.2 Combat

Apr√®s que le joueur frappe :
Si player.familiarAttack > 0, l‚Äôanimal attaque automatiquement :
Exemple :
üêæ Dragon familier inflige 6 d√©g√¢ts √† Gobelin #1.
Si le familier tue l‚Äôennemi ‚Üí r√©compenses normales

11.3 Familiers impl√©ment√©s

ID	Nom	Raret√©	famAttack	DEF	Co√ªt
pet_dragon	Dragon familier	Epic	6	2	800
pet_dog	Chien fid√®le	Rare	2	1	120

11.4 Tests rapides

Console :
player.inventory.push({ id: 'pet_dragon', name: 'Dragon familier', rarity: 'epic' });
updateStats();

12. Interface & Mobile

Inventaire adapt√© pour mobile
Tap ‚Üí d√©s√©quiper
UI responsive
Shop am√©lior√© : tooltips + stats inline

13. Am√©liorations Techniques r√©centes

Ajout champs hp, dodge, crit sur les items
Esquives + critiques pour joueur & ennemis
Suppression scaling ennemi d√©pendant joueur
Donjons d√©terministes (seed)
Nettoyage affichage des items (type, stats, tooltip)

14. Options futures / Backlog

Persistance HP ennemis dans donjons
Ajustement multiplicateurs ennemis
Style CSS d√©di√© aux stats items
Boss uniques par palier
Forge / crafting
Syst√®me d‚Äô√©l√©ments (feu, glace, poison)
Comp√©tences actives (skills)
Familiers avanc√©s (√©volutions, leveling)
Multi / WebSocket
Transitions & particules
IA ennemie (patrouille, aggro)

15. Annexes

‚Üí Possibilit√© : g√©n√©ration d‚Äôun fichier CSV des taux exacts de drop par item.